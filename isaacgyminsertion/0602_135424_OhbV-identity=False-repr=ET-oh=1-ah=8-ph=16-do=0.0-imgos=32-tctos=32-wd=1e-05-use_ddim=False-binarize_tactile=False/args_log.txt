_metadata: ContainerMetadata(ref_type=typing.Any, object_type=<class 'dict'>, optional=True, key='diffusion_train', flags={}, flags_root=False, resolver_cache=defaultdict(<class 'dict'>, {}), key_type=typing.Any, element_type=typing.Any)
_parent: {'task': {'mode': {'export_scene': False, 'export_states': False}, 'sim': {'dt': 0.0167, 'substeps': 3, 'up_axis': 'z', 'use_gpu_pipeline': '${eq:${...pipeline},"gpu"}', 'gravity': [0.0, 0.0, -9.81], 'add_damping': True, 'physx': {'solver_type': '${....solver_type}', 'num_threads': '${....num_threads}', 'num_subscenes': '${....num_subscenes}', 'use_gpu': '${contains:"cuda",${....sim_device}}', 'num_position_iterations': 16, 'num_velocity_iterations': 0, 'contact_offset': 0.005, 'rest_offset': 0.0, 'bounce_threshold_velocity': 0.2, 'max_depenetration_velocity': 5.0, 'friction_offset_threshold': 0.01, 'friction_correlation_distance': 0.00625, 'max_gpu_contact_pairs': 1048576, 'default_buffer_size_multiplier': 8.0, 'contact_collection': 1}, 'disable_gravity': True}, 'env': {'env_spacing': 0.5, 'kuka_depth': 0.5, 'table_height': 0.001, 'kuka_friction': 1.0, 'table_friction': 0.3, 'numEnvs': '${resolve_default:128,${...num_envs}}', 'numObservations': 18, 'numObsStudent': 9, 'numStates': 7, 'numActions': 6, 'numTargets': 6, 'numObsHist': 1, 'numObsStudentHist': 1, 'ft_history_len': 30, 'tactile_history_len': 1, 'img_history_len': 1, 'smooth_force': True, 'openhand': {'distal_open': 0.1, 'distal_close': 0.4, 'proximal_open': 1.0, 'proximal_close': 2.3, 'base_angle': 0.7, 'tactile_finger': ['finger_1_3', 'finger_2_3', 'finger_3_3']}, 'num_gripper_move_sim_steps': 120, 'num_gripper_close_sim_steps': 50, 'num_gripper_lift_sim_steps': 25, 'socket_pos_obs_noise': [0.001, 0.001, 0.001], 'socket_rot_obs_noise': [0.0, 0.0, 0.0], 'socket_base_height': 0.003, 'plug_grasp_threshold': 0.01, 'tactile': False, 'tactile_display_viz': False, 'tactile_wrt_force': False, 'compute_contact_gt': False, 'num_points': 2, 'record_video': True, 'record_ft': True, 'record_video_every': 1000, 'record_ft_every': 1000}, 'name': 'FactoryTaskInsertionTactile', 'physics_engine': '${..physics_engine}', 'grasp_at_init': True, 'grasp_logger': {'total_grasp': 1000}, 'data_logger': {'collect_data': False, 'total_trajectories': 1000, 'base_folder': '/home/roblab20/tactile_insertion', 'sub_folder': 'datastore_0_contact2', 'collect_test_sim': '${...offline_training_w_env}'}, 'tactile': {'tacto': {'width': 224, 'height': 224, 'visualize_gui': True}, 'with_bg': True, 'show_depth': True, 'show_detect': False, 'diff': True, 'half_image': True, 'tactile_freq': 2, 'encoder': {'width': 224, 'height': 224, 'num_channels': 3}, 'sim2real': False, 'model_G': 'latest_net_G_B.pth'}, 'external_cam': {'external_cam': False, 'cam_res': {'w': 320, 'h': 180}, 'cam_type': 'd', 'save_im': False, 'far_clip': 1.0, 'near_clip': 0.0, 'dis_noise': 0.001}, 'randomize': {'force_scale': 0.0, 'kuka_arm_initial_dof_pos': [0.0064, 0.2375, -0.0075, -1.2022, 0.0015, 1.69, -1.5699], 'fingertip_midpoint_rot_initial': [-3.14159265359, 0.0, -1.57079632679], 'same_socket': False, 'plug_pos_xy_initial': [0.5, 0.0, 0.0], 'plug_pos_xy_noise': [0.01, 0.01], 'plug_quat_noise': [0.0, 0.0, 0.0, 0.0], 'socket_pos_xy_initial': [0.5, 0.0, 0.0], 'socket_pos_xy_noise': [0.01, 0.01], 'socket_rot_euler_noise': 0.035, 'socket_pos_z_noise_bounds': [-0.002, 0.003], 'plug_pos_z_noise_bounds': [0.003, 0.015], 'grasp_plug_noise': 0.005, 'above_socket_noise': [0.03, 0.03, 0.001], 'plug_rot_noise': [0.05, 0.05, 0.05]}, 'rl': {'pos_action_scale': [0.005, 0.005, 0.004], 'rot_action_scale': [0.04, 0.04, 0.04], 'force_action_scale': [1.0, 1.0, 1.0], 'torque_action_scale': [1.0, 1.0, 1.0], 'unidirectional_rot': True, 'unidirectional_force': False, 'clamp_rot': True, 'clamp_rot_thresh': 1e-06, 'num_keypoints': 4, 'keypoint_scale': 1.0, 'max_episode_length': 500, 'orientation_threshold': 0.1, 'far_error_thresh': 0.1, 'close_error_thresh': 0.005, 'success_height_thresh': 0.005, 'keypoint_reward_scale': -0.4, 'action_penalty_scale': -0.002, 'action_delta_scale': -0.02, 'ori_reward_scale': -0.1, 'early_reset_reward_scale': -1.0, 'engagement_reward_scale': 0.4, 'success_bonus': 5.0}, 'ctrl': {'ctrl_type': 'gym_default', 'all': {'jacobian_type': 'geometric', 'gripper_prop_gains': [10, 10, 10, 10, 10, 10, 10, 10], 'gripper_deriv_gains': [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2]}, 'gym_default': {'ik_method': 'dls', 'joint_prop_gains': [290, 208, 145, 145, 232, 204, 176], 'joint_deriv_gains': [81, 80, 40, 43, 75, 82, 47], 'gripper_prop_gains': [10, 10, 10, 10, 10, 10, 10, 10], 'gripper_deriv_gains': [0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2]}, 'joint_space_ik': {'ik_method': 'dls', 'joint_prop_gains': [1, 1, 1, 1, 1, 1, 1], 'joint_deriv_gains': [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]}, 'joint_space_id': {'ik_method': 'dls', 'joint_prop_gains': [290, 208, 145, 145, 232, 204, 176], 'joint_deriv_gains': [81, 80, 40, 43, 75, 82, 47]}, 'task_space_impedance': {'motion_ctrl_axes': [1, 1, 1, 1, 1, 1], 'task_prop_gains': [300, 300, 300, 50, 50, 50], 'task_deriv_gains': [34, 34, 34, 1.4, 1.4, 1.4]}, 'operational_space_motion': {'motion_ctrl_axes': [1, 1, 1, 1, 1, 1], 'task_prop_gains': [200, 200, 200, 200, 200, 200], 'task_deriv_gains': [10, 10, 10, 10, 10, 10]}, 'open_loop_force': {'force_ctrl_axes': [1, 1, 1, 1, 1, 1]}, 'closed_loop_force': {'force_ctrl_axes': [1, 1, 1, 1, 1, 1], 'wrench_prop_gains': [0.1, 0.1, 0.1, 0.1, 0.1, 0.1]}, 'hybrid_force_motion': {'motion_ctrl_axes': [1, 1, 1, 1, 1, 1], 'task_prop_gains': [40, 40, 40, 40, 40, 40], 'task_deriv_gains': [8, 8, 8, 8, 8, 8], 'force_ctrl_axes': [1, 1, 1, 1, 1, 1], 'wrench_prop_gains': [0.1, 0.1, 0.1, 0.1, 0.1, 0.1]}}}, 'train': {'seed': '${..seed}', 'algo': 'PPO', 'load_path': '${..checkpoint}', 'network': {'mlp': {'units': [512, 256, 128]}, 'priv_mlp': {'units': [256, 128, 8]}, 'contact_mlp': {'units': [128, 64, 8]}, 'ft_mlp': {'units': [128, 64, 8]}, 'obs_mlp': {'units': [512, 128, 32]}, 'tactile_mlp': {'units': [300, 128, 32]}, 'merge_mlp': {'units': [128, 64, 8]}, 'hand_mlp': {'units': [128, 64, 8]}, 'tactile_encoder': {'num_channels': '${....task.tactile.encoder.num_channels}', 'tactile_seq_length': '${....task.env.tactile_history_len}', 'img_width': '${....task.tactile.encoder.width}', 'img_height': '${....task.tactile.encoder.height}'}}, 'ppo': {'output_name': 'debug', 'multi_gpu': False, 'normalize_input': True, 'normalize_value': True, 'value_bootstrap': True, 'shared_parameters': False, 'num_actors': '${...task.env.numEnvs}', 'normalize_advantage': True, 'gamma': 0.99, 'tau': 0.95, 'learning_rate': 0.00025, 'kl_threshold': 0.02, 'horizon_length': 32, 'mini_epochs': 8, 'minibatch_size': 24, 'clip_value': True, 'critic_coef': 4, 'entropy_coef': 0.0, 'e_clip': 0.2, 'bounds_loss_coef': 0.0001, 'truncate_grads': True, 'grad_norm': 1, 'save_best_after': 0, 'save_frequency': 100, 'max_agent_steps': 1500000000, 'priv_info': True, 'extrin_adapt': False, 'tactile_info': False, 'ft_info': False, 'obs_info': False, 'hand_info': False, 'only_contact': False, 'split_latent': False, 'ft_seq_length': '${...task.env.ft_history_len}', 'obs_seq_length': '${...task.env.numObsHist}', 'priv_info_dim': '${...task.env.numStates}', 'compute_contact_gt': '${...task.env.compute_contact_gt}', 'num_points': '${...task.env.num_points}', 'sim2real': '${...task.tactile.sim2real}', 'student_obs_input_shape': '${...task.env.numObsStudent}', 'save_buffer': False, 'ft_input_dim': 6}}, 'deploy': {'seed': '${..seed}', 'algo': 'ExtrinsicAdapt', 'load_path': '${..checkpoint}', 'desired_subassemblies': ['yellow_round_peg_2in'], 'record_video': True, 'record_ft': True, 'tactile_display_viz': True, 'data_logger': {'collect_data': False, 'total_trajectories': 10, 'base_folder': '/home/roblab20/tactile_diffusion', 'sub_folder': 'datastore_real'}, 'rl': {'max_episode_length': 500, 'pos_action_scale': [0.005, 0.005, 0.004], 'rot_action_scale': [0.02, 0.02, 0.02], 'clamp_rot': '${...task.rl.clamp_rot}', 'clamp_rot_thresh': '${...task.rl.clamp_rot_thresh}'}, 'env': {'tactile_seq_length': '${...task.env.tactile_history_len}', 'ft_seq_length': '${...task.env.ft_history_len}', 'obs_seq_length': '${...task.env.numObsHist}', 'stud_obs_seq_length': '${...task.env.numObsStudentHist}', 'priv_info_dim': '${...task.env.numStates}', 'numObservations': '${...task.env.numObservations}', 'numObsStudent': '${...task.env.numObsStudent}', 'numActions': '${...task.env.numActions}', 'numTargets': '${...task.env.numTargets}', 'socket_pos_obs_noise': [0.001, 0.001, 0.0], 'socket_rot_obs_noise': [0.0, 0.0, 0.0], 'fingertip_midpoint_rot_initial': [-3.14159265359, 0.0, -1.57079632679], 'kuka_depth': '${...task.env.kuka_depth}', 'table_height': '${...task.env.table_height}', 'compute_contact_gt': '${...task.env.compute_contact_gt}', 'only_contact': '${...task.env.only_contact}', 'num_points': '${...task.env.num_points}'}, 'ppo': {'priv_info': True, 'extrin_adapt': False, 'tactile_info': False, 'obs_info': False, 'ft_info': False, 'tactile_seq_length': '${...task.env.tactile_history_len}', 'ft_seq_length': '${...task.env.ft_history_len}', 'obs_seq_length': '${...task.env.numObsHist}', 'stud_obs_seq_length': '${...task.env.numObsStudentHist}', 'priv_info_dim': '${...task.env.numStates}', 'student_obs_input_shape': '${...task.env.numObsStudent}', 'ft_input_dim': 6}, 'network': {'mlp': {'units': [512, 256, 128]}, 'priv_mlp': {'units': [256, 128, 8]}, 'ft_mlp': {'units': [128, 64, 16]}, 'obs_mlp': {'units': [1024, 512, 128, 32]}, 'tactile_mlp': {'units': [300, 128, 32]}, 'merge_mlp': {'units': [128, 64, 8]}, 'contact_mlp': {'units': [128, 64, 8]}, 'tactile_encoder': {'num_channels': '${....task.tactile.encoder.num_channels}', 'tactile_seq_length': '${....task.env.tactile_history_len}', 'img_width': '${....task.tactile.encoder.width}', 'img_height': '${....task.tactile.encoder.height}'}}, 'common_poses': {'socket_pos': [0.4983277482766424, 0.005448238941323905, 0.001], 'joints_above_socket': [-0.01306919673345508, 0.46035625642851, -3.115810324760627, -1.5234410615555438, -0.012022574425053278, -1.1572361716453639, 1.5847205313963213, 0.0], 'joints_above_plug': [-0.4343525190442179, 0.3393440474185589, -3.118461501625801, -1.762369221913092, -0.010365555594806786, -1.0404064904168955, 1.172501677329807]}}, 'pbt': {'enabled': False}, 'offline_train': {'seed': 42, 'data_folder': '/home/roblab20/tactile_insertion/datastore_42_contact2', 'output_dir': '/home/roblab20/tactile_insertion/datastore_42_contact2', 'train': {'epochs': 100, 'train_batch_size': 16, 'val_batch_size': 16, 'learning_rate': 0.0005, 'train_test_split': 0.98, 'action_regularization': False, 'action_regularization_weight': 0.0, 'scheduler': 'cosine', 'warmup': False, 'warmup_epochs': 4, 'cyclic_period': 10, 'plateau_patience': 3, 'plateau_factor': 0.5, 'latent_scale': 1.0, 'action_scale': 1.0, 'print_every': 100, 'eval_every': 4000, 'test_every': 10000, 'test_episodes': 2, 'only_test': False, 'only_validate': False, 'normalize_keys': ['eef_pos', 'action', 'hand_joints', 'plug_pos_error', 'plug_quat_error', 'plug_hand_quat', 'plug_hand_pos'], 'normalize_file': '/home/roblab20/tactile_insertion/datastore_42_contact2/normalization.pkl', 'load_checkpoint': False, 'student_ckpt_path': '/home/roblab20/tactile_insertion/datastore_0_contact2/tac+eef/checkpoints/model_2.pt'}, 'model': {'linear': {'input_size': 6}, 'cnn': {'in_channels': 3}, 'transformer': {'full_sequence': False, 'sequence_length': 1, 'num_layers': 4, 'num_heads': 4, 'dim_factor': 4, 'output_size': 8, 'tactile_encoding_size': 128, 'img_encoding_size': 128}}, 'wandb': {'wandb_enabled': False, 'wandb_project_name': 'tactile_insertion'}}, 'diffusion_train': {'data_folder': '/home/roblab20/tactile_insertion/datastore_xxx', 'output_dir': '/home/roblab20/tactile_insertion/datastore_xxx', 'add_model_save_path_suffix': True, 'eval': False, 'save_freq': 10, 'eval_freq': 10, 'print_freq': 100, 'load_checkpoint': False, 'model_save_path': '', 'load_path': '', 'gpu': 0, 'epochs': 100, 'obs_horizon': 1, 'action_horizon': 8, 'pred_horizon': 16, 'batch_size': 16, 'learning_rate': 0.0005, 'train_test_split': 0.9, 'representation_type': 'eef_pos-tactile', 'scheduler': 'cosine', 'warmup': False, 'warmup_epochs': 4, 'cyclic_period': 10, 'plateau_patience': 3, 'plateau_factor': 0.5, 'normalize_keys': ['eef_pos', 'action', 'hand_joints', 'arm_joints'], 'normalize_file': '/home/roblab20/tactile_insertion/datastore_42_contact2/normalization.pkl', 'img_color_jitter': False, 'tactile_color_jitter': False, 'predict_eef_delta': False, 'clip_far': False, 'predict_pos_delta': False, 'use_ddim': False, 'policy_dropout_rate': 0.0, 'dropout_rate': 0.0, 'img_dropout_rate': 0.0, 'weight_decay': 1e-05, 'image_output_size': 32, 'tactile_output_size': 32, 'state_noise': 0.0, 'img_gaussian_noise': 0.0, 'img_masking_prob': 0.0, 'img_patch_size': 16, 'tactile_gaussian_noise': 0.0, 'tactile_masking_prob': 0.0, 'tactile_patch_size': 16, 'num_workers': 8, 'without_sampling': False, 'binarize_tactile': False, 'use_memmap_cache': False, 'img_memmap_loader_path': 'None', 'tactile_memmap_loader_path': 'None', 'compile_train': False, 'num_diffusion_iters': 100, 'identity_encoder': False, 'load_img': False, 'linear_input_size': 6, 'full_sequence': False, 'sequence_length': 1, 'num_layers': 4, 'num_heads': 4, 'dim_factor': 4, 'output_size': 8, 'tactile_encoding_size': 128, 'img_encoding_size': 128, 'wandb_entity_name': 'None', 'wandb_exp_name': 'None', 'use_wandb': False, 'wandb_project_name': 'tactile_insertion', 'tactile': {'tacto': {'width': 224, 'height': 224, 'visualize_gui': True}, 'with_bg': True, 'show_depth': True, 'diff': True, 'half_image': True, 'tactile_freq': 2, 'encoder': {'width': 224, 'height': 224, 'num_channels': 3}, 'sim2real': False, 'model_G': 'latest_net_G_B.pth'}, 'external_cam': {'external_cam': False, 'cam_res': {'w': 320, 'h': 180}, 'cam_type': 'depth', 'save_im': False, 'far_clip': 1.0, 'near_clip': 0.0, 'dis_noise': 0.001}}, 'task_name': '${task.name}', 'experiment': '', 'num_envs': 12, 'seed': 42, 'torch_deterministic': False, 'max_iterations': '', 'physics_engine': 'physx', 'pipeline': 'gpu', 'sim_device': 'cuda:0', 'rl_device': 'cuda:0', 'graphics_device_id': 0, 'num_threads': 4, 'solver_type': 1, 'num_subscenes': 4, 'test': False, 'train_diffusion': True, 'offline_training': False, 'offline_real_training': False, 'offline_training_w_env': False, 'checkpoint': '', 'sigma': '', 'multi_gpu': False, 'wandb_activate': False, 'wandb_group': '', 'wandb_name': '${train.params.config.name}', 'wandb_entity': '', 'wandb_project': 'isaacgymenvs', 'wandb_tags': [], 'wandb_logcode_dir': '', 'capture_video': True, 'capture_video_freq': 1464, 'capture_video_len': 100, 'force_render': True, 'headless': False}
_flags_cache: {'struct': True}
_content: {'data_folder': '/home/roblab20/tactile_insertion/datastore_xxx', 'output_dir': '/home/roblab20/tactile_insertion/datastore_xxx', 'add_model_save_path_suffix': True, 'eval': False, 'save_freq': 10, 'eval_freq': 10, 'print_freq': 100, 'load_checkpoint': False, 'model_save_path': '', 'load_path': '', 'gpu': 0, 'epochs': 100, 'obs_horizon': 1, 'action_horizon': 8, 'pred_horizon': 16, 'batch_size': 16, 'learning_rate': 0.0005, 'train_test_split': 0.9, 'representation_type': 'eef_pos-tactile', 'scheduler': 'cosine', 'warmup': False, 'warmup_epochs': 4, 'cyclic_period': 10, 'plateau_patience': 3, 'plateau_factor': 0.5, 'normalize_keys': ['eef_pos', 'action', 'hand_joints', 'arm_joints'], 'normalize_file': '/home/roblab20/tactile_insertion/datastore_42_contact2/normalization.pkl', 'img_color_jitter': False, 'tactile_color_jitter': False, 'predict_eef_delta': False, 'clip_far': False, 'predict_pos_delta': False, 'use_ddim': False, 'policy_dropout_rate': 0.0, 'dropout_rate': 0.0, 'img_dropout_rate': 0.0, 'weight_decay': 1e-05, 'image_output_size': 32, 'tactile_output_size': 32, 'state_noise': 0.0, 'img_gaussian_noise': 0.0, 'img_masking_prob': 0.0, 'img_patch_size': 16, 'tactile_gaussian_noise': 0.0, 'tactile_masking_prob': 0.0, 'tactile_patch_size': 16, 'num_workers': 8, 'without_sampling': False, 'binarize_tactile': False, 'use_memmap_cache': False, 'img_memmap_loader_path': 'None', 'tactile_memmap_loader_path': 'None', 'compile_train': False, 'num_diffusion_iters': 100, 'identity_encoder': False, 'load_img': False, 'linear_input_size': 6, 'full_sequence': False, 'sequence_length': 1, 'num_layers': 4, 'num_heads': 4, 'dim_factor': 4, 'output_size': 8, 'tactile_encoding_size': 128, 'img_encoding_size': 128, 'wandb_entity_name': 'None', 'wandb_exp_name': 'None', 'use_wandb': False, 'wandb_project_name': 'tactile_insertion', 'tactile': {'tacto': {'width': 224, 'height': 224, 'visualize_gui': True}, 'with_bg': True, 'show_depth': True, 'diff': True, 'half_image': True, 'tactile_freq': 2, 'encoder': {'width': 224, 'height': 224, 'num_channels': 3}, 'sim2real': False, 'model_G': 'latest_net_G_B.pth'}, 'external_cam': {'external_cam': False, 'cam_res': {'w': 320, 'h': 180}, 'cam_type': 'depth', 'save_im': False, 'far_clip': 1.0, 'near_clip': 0.0, 'dis_noise': 0.001}}