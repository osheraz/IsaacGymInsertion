hydra:
  run:
    dir: .
  sweep:
    dir: multirun/${now:%Y-%m-%d}/${now:%H-%M-%S}
    subdir: ${hydra.job.num}
  launcher:
    _target_: hydra._internal.core_plugins.basic_launcher.BasicLauncher
  sweeper:
    _target_: hydra._internal.core_plugins.basic_sweeper.BasicSweeper
    max_batch_size: null
    params: null
  help:
    app_name: ${hydra.job.name}
    header: '${hydra.help.app_name} is powered by Hydra.

      '
    footer: 'Powered by Hydra (https://hydra.cc)

      Use --hydra-help to view Hydra specific help

      '
    template: '${hydra.help.header}

      == Configuration groups ==

      Compose your configuration from those groups (group=option)


      $APP_CONFIG_GROUPS


      == Config ==

      Override anything in the config (foo.bar=value)


      $CONFIG


      ${hydra.help.footer}

      '
  hydra_help:
    template: 'Hydra (${hydra.runtime.version})

      See https://hydra.cc for more info.


      == Flags ==

      $FLAGS_HELP


      == Configuration groups ==

      Compose your configuration from those groups (For example, append hydra/job_logging=disabled
      to command line)


      $HYDRA_CONFIG_GROUPS


      Use ''--cfg hydra'' to Show the Hydra config.

      '
    hydra_help: ???
  hydra_logging:
    version: 1
    formatters:
      simple:
        format: '[%(asctime)s][HYDRA] %(message)s'
    handlers:
      console:
        class: logging.StreamHandler
        formatter: simple
        stream: ext://sys.stdout
    root:
      level: INFO
      handlers:
      - console
    loggers:
      logging_example:
        level: DEBUG
    disable_existing_loggers: false
  job_logging:
    version: 1
    root:
      level: ERROR
    disable_existing_loggers: true
  env: {}
  mode: MULTIRUN
  searchpath: []
  callbacks: {}
  output_subdir: null
  overrides:
    hydra:
    - hydra.mode=MULTIRUN
    task:
    - task=FactoryTaskInsertionTactile
    - headless=True
    - seed=42
    - task.env.numEnvs=10
    - task.env.tactile=False
    - task.env.tactile_display_viz=False
    - task.env.smooth_force=True
    - task.env.numObsHist=1
    - task.env.numObservations=18
    - task.env.numStates=14
    - task.env.compute_contact_gt=False
    - train.ppo.only_contact=False
    - train.algo=PPO
    - train.ppo.priv_info=True
    - train.ppo.extrin_adapt=False
    - train.ppo.tactile_info=False
    - task.external_cam.external_cam=False
    - train.ppo.output_name=test
  job:
    name: train
    chdir: null
    override_dirname: headless=True,seed=42,task.env.compute_contact_gt=False,task.env.numEnvs=10,task.env.numObsHist=1,task.env.numObservations=18,task.env.numStates=14,task.env.smooth_force=True,task.env.tactile=False,task.env.tactile_display_viz=False,task.external_cam.external_cam=False,task=FactoryTaskInsertionTactile,train.algo=PPO,train.ppo.extrin_adapt=False,train.ppo.only_contact=False,train.ppo.output_name=test,train.ppo.priv_info=True,train.ppo.tactile_info=False
    id: ???
    num: ???
    config_name: config
    env_set: {}
    env_copy: []
    config:
      override_dirname:
        kv_sep: '='
        item_sep: ','
        exclude_keys: []
  runtime:
    version: 1.3.2
    version_base: '1.1'
    cwd: /home/osher/osher3_workspace/src/isaacgym/python/IsaacGymInsertion/isaacgyminsertion
    config_sources:
    - path: hydra.conf
      schema: pkg
      provider: hydra
    - path: /home/osher/osher3_workspace/src/isaacgym/python/IsaacGymInsertion/isaacgyminsertion/cfg
      schema: file
      provider: main
    - path: ''
      schema: structured
      provider: schema
    output_dir: ???
    choices:
      diffusion_train: diffusion_config
      offline_train: offline_config
      pbt: no_pbt
      task: FactoryTaskInsertionTactile
      deploy: FactoryTaskInsertionTactileDeploy
      train: FactoryTaskInsertionTactilePPOv2
      hydra/env: default
      hydra/callbacks: null
      hydra/job_logging: disabled
      hydra/hydra_logging: default
      hydra/hydra_help: default
      hydra/help: default
      hydra/sweeper: basic
      hydra/launcher: basic
      hydra/output: default
  verbose: false
task:
  mode:
    export_scene: false
    export_states: false
  sim:
    dt: 0.0167
    substeps: 3
    up_axis: z
    use_gpu_pipeline: ${eq:${...pipeline},"gpu"}
    gravity:
    - 0.0
    - 0.0
    - -9.81
    add_damping: true
    physx:
      solver_type: ${....solver_type}
      num_threads: ${....num_threads}
      num_subscenes: ${....num_subscenes}
      use_gpu: ${contains:"cuda",${....sim_device}}
      num_position_iterations: 16
      num_velocity_iterations: 0
      contact_offset: 0.005
      rest_offset: 0.0
      bounce_threshold_velocity: 0.2
      max_depenetration_velocity: 5.0
      friction_offset_threshold: 0.01
      friction_correlation_distance: 0.00625
      max_gpu_contact_pairs: 1048576
      default_buffer_size_multiplier: 8.0
      contact_collection: 1
    disable_gravity: true
  env:
    env_spacing: 0.5
    kuka_depth: 0.5
    table_height: 0.001
    kuka_friction: 1.0
    table_friction: 0.3
    numEnvs: 10
    numObservations: 18
    numObsStudent: 9
    numStates: 14
    numActions: 6
    numTargets: 6
    action_latency_max: 15
    numObsHist: 1
    numObsStudentHist: 1
    ft_history_len: 30
    tactile_history_len: 1
    img_history_len: 1
    smooth_force: true
    openhand:
      distal_open: 0.1
      distal_close: 0.4
      proximal_open: 1.0
      proximal_close: 2.4
      proximal_noise: 0.1
      distal_noise: 0.2
      base_angle: 0.7
      tactile_finger:
      - finger_1_3
      - finger_2_3
      - finger_3_3
    actionsMovingAverage:
      range:
      - 0.15
      - 0.35
      schedule_steps: 1000000
      schedule_freq: 500
    actionLatencyMax: 15
    actionLatencyScheduledSteps: 10000000
    actionDelayProbMax: 0.3
    plugObsDelayProb: 0.3
    ImgDelayProb: 0.3
    TactileDelayProb: 0.3
    maxObjectSkipObs: 2
    maxSkipImg: 4
    maxSkipTactile: 4
    scalePosProb: 0.3
    scaleRotProb: 0.3
    num_gripper_move_sim_steps: 120
    num_gripper_close_sim_steps: 50
    num_gripper_lift_sim_steps: 25
    socket_priv_obs_noise:
    - 0.001
    - 0.001
    - 0.001
    socket_pos_obs_noise:
    - 0.005
    - 0.005
    - 0.005
    socket_rot_obs_noise:
    - 0.0
    - 0.0
    - 0.0
    socket_base_height: 0.003
    plug_grasp_threshold: 0.01
    tactile: false
    tactile_display_viz: false
    tactile_wrt_force: false
    compute_contact_gt: false
    num_points: 2
    record_video: true
    record_ft: true
    record_video_every: 1000
    record_ft_every: 1000
  name: FactoryTaskInsertionTactile
  physics_engine: ${..physics_engine}
  grasp_at_init: true
  collect_rotate: false
  grasp_logger:
    total_grasp: 1000
  data_logger:
    collect_data: false
    total_trajectories: 20000
    base_folder: /home/roblab20/tactile_insertion
    sub_folder: ''
    collect_test_sim: ${...offline_training_w_env}
  tactile:
    tacto:
      width: 128
      height: 128
      visualize_gui: true
    with_bg: true
    show_depth: false
    show_detect: false
    diff: true
    crop_roi: true
    encoder:
      width: 128
      height: 128
      num_channels: 1
    sim2real: false
    model_G: latest_net_G_B.pth
  external_cam:
    external_cam: false
    cam_res:
      w: 320
      h: 180
    cam_type: d
    save_im: false
    far_clip: 1.0
    near_clip: 0.0
    dis_noise: 0.001
    display: false
  randomize:
    force_scale: 0.0
    kuka_arm_initial_dof_pos:
    - 0.0064
    - 0.2375
    - -0.0075
    - -1.2022
    - 0.0015
    - 1.69
    - -1.5699
    fingertip_midpoint_rot_initial:
    - -3.14159265359
    - 0.0
    - -1.57079632679
    same_socket: false
    plug_pos_xy_initial:
    - 0.5
    - 0.0
    - 0.0
    plug_pos_xy_noise:
    - 0.01
    - 0.01
    plug_quat_noise:
    - 0.0
    - 0.0
    - 0.0
    - 0.0
    plug_pos_z_noise_bounds:
    - 0.005
    - 0.015
    socket_pos_xy_initial:
    - 0.5
    - 0.0
    - 0.0
    socket_pos_xy_noise:
    - 0.01
    - 0.01
    socket_rot_euler_noise: 0.035
    socket_pos_z_noise_bounds:
    - -0.002
    - 0.003
    scale_noise_pos:
    - 0.003
    - 0.003
    - 0.003
    scale_noise_rot:
    - 0.03
    - 0.03
    - 0.03
    grasp_plug_noise: 0.005
    above_socket_noise:
    - 0.03
    - 0.03
    - 0.001
    plug_rot_noise:
    - 0.15
    - 0.15
    - 0.05
  rl:
    pos_action_scale:
    - 0.005
    - 0.005
    - 0.004
    rot_action_scale:
    - 0.04
    - 0.04
    - 0.04
    force_action_scale:
    - 1.0
    - 1.0
    - 1.0
    torque_action_scale:
    - 1.0
    - 1.0
    - 1.0
    unidirectional_rot: true
    unidirectional_force: false
    clamp_rot: true
    clamp_rot_thresh: 1.0e-06
    num_keypoints: 4
    keypoint_scale: 1.0
    max_episode_length: 500
    orientation_threshold: 0.1
    far_error_thresh: 0.1
    close_error_thresh: 0.005
    success_height_thresh: 0.005
    keypoint_reward_scale: -0.4
    action_penalty_scale: -0.07
    action_delta_scale: -0.07
    ori_reward_scale: -0.1
    early_reset_reward_scale: -1.0
    engagement_reward_scale: 0.4
    success_bonus: 5.0
  ctrl:
    ctrl_type: gym_default
    all:
      jacobian_type: geometric
      gripper_prop_gains:
      - 10
      - 10
      - 10
      - 10
      - 10
      - 10
      - 10
      - 10
      gripper_deriv_gains:
      - 0.2
      - 0.2
      - 0.2
      - 0.2
      - 0.2
      - 0.2
      - 0.2
      - 0.2
    gym_default:
      ik_method: dls
      joint_prop_gains:
      - 290
      - 208
      - 145
      - 145
      - 232
      - 204
      - 176
      joint_deriv_gains:
      - 81
      - 80
      - 40
      - 43
      - 75
      - 82
      - 47
      gripper_prop_gains:
      - 10
      - 10
      - 10
      - 10
      - 10
      - 10
      - 10
      - 10
      gripper_deriv_gains:
      - 0.2
      - 0.2
      - 0.2
      - 0.2
      - 0.2
      - 0.2
      - 0.2
      - 0.2
    joint_space_ik:
      ik_method: dls
      joint_prop_gains:
      - 1
      - 1
      - 1
      - 1
      - 1
      - 1
      - 1
      joint_deriv_gains:
      - 0.1
      - 0.1
      - 0.1
      - 0.1
      - 0.1
      - 0.1
      - 0.1
    joint_space_id:
      ik_method: dls
      joint_prop_gains:
      - 290
      - 208
      - 145
      - 145
      - 232
      - 204
      - 176
      joint_deriv_gains:
      - 81
      - 80
      - 40
      - 43
      - 75
      - 82
      - 47
    task_space_impedance:
      motion_ctrl_axes:
      - 1
      - 1
      - 1
      - 1
      - 1
      - 1
      task_prop_gains:
      - 300
      - 300
      - 300
      - 50
      - 50
      - 50
      task_deriv_gains:
      - 34
      - 34
      - 34
      - 1.4
      - 1.4
      - 1.4
    operational_space_motion:
      motion_ctrl_axes:
      - 1
      - 1
      - 1
      - 1
      - 1
      - 1
      task_prop_gains:
      - 200
      - 200
      - 200
      - 200
      - 200
      - 200
      task_deriv_gains:
      - 10
      - 10
      - 10
      - 10
      - 10
      - 10
    open_loop_force:
      force_ctrl_axes:
      - 1
      - 1
      - 1
      - 1
      - 1
      - 1
    closed_loop_force:
      force_ctrl_axes:
      - 1
      - 1
      - 1
      - 1
      - 1
      - 1
      wrench_prop_gains:
      - 0.1
      - 0.1
      - 0.1
      - 0.1
      - 0.1
      - 0.1
    hybrid_force_motion:
      motion_ctrl_axes:
      - 1
      - 1
      - 1
      - 1
      - 1
      - 1
      task_prop_gains:
      - 40
      - 40
      - 40
      - 40
      - 40
      - 40
      task_deriv_gains:
      - 8
      - 8
      - 8
      - 8
      - 8
      - 8
      force_ctrl_axes:
      - 1
      - 1
      - 1
      - 1
      - 1
      - 1
      wrench_prop_gains:
      - 0.1
      - 0.1
      - 0.1
      - 0.1
      - 0.1
      - 0.1
train:
  seed: ${..seed}
  algo: PPO
  load_path: ${..checkpoint}
  network:
    mlp:
      units:
      - 512
      - 256
      - 128
    priv_mlp:
      units:
      - 256
      - 128
      - 8
    contact_mlp:
      units:
      - 128
      - 64
      - 8
    ft_mlp:
      units:
      - 128
      - 64
      - 8
    obs_mlp:
      units:
      - 512
      - 128
      - 32
    tactile_mlp:
      units:
      - 300
      - 128
      - 32
    merge_mlp:
      units:
      - 128
      - 64
      - 8
    hand_mlp:
      units:
      - 128
      - 64
      - 8
    tactile_encoder:
      num_channels: ${....task.tactile.encoder.num_channels}
      tactile_seq_length: ${....task.env.tactile_history_len}
      img_width: ${....task.tactile.encoder.width}
      img_height: ${....task.tactile.encoder.height}
  ppo:
    output_name: test
    multi_gpu: ${...multi_gpu}
    normalize_input: true
    normalize_value: true
    value_bootstrap: true
    shared_parameters: false
    num_actors: ${...task.env.numEnvs}
    normalize_advantage: true
    gamma: 0.99
    tau: 0.95
    learning_rate: 0.00025
    kl_threshold: 0.02
    horizon_length: 32
    mini_epochs: 8
    minibatch_size: 24
    clip_value: true
    critic_coef: 4
    entropy_coef: 0.0
    e_clip: 0.2
    bounds_loss_coef: 0.0001
    truncate_grads: true
    grad_norm: 1
    save_best_after: 0
    save_frequency: 100
    max_agent_steps: 1500000000
    priv_info: true
    extrin_adapt: false
    tactile_info: false
    ft_info: false
    obs_info: false
    hand_info: false
    only_contact: false
    split_latent: false
    ft_seq_length: ${...task.env.ft_history_len}
    obs_seq_length: ${...task.env.numObsHist}
    priv_info_dim: ${...task.env.numStates}
    compute_contact_gt: ${...task.env.compute_contact_gt}
    num_points: ${...task.env.num_points}
    sim2real: ${...task.tactile.sim2real}
    student_obs_input_shape: ${...task.env.numObsStudent}
    save_buffer: false
    ft_input_dim: 6
deploy:
  seed: ${..seed}
  algo: ExtrinsicAdapt
  load_path: ${..checkpoint}
  desired_subassemblies:
  - yellow_round_peg_2in
  record_video: true
  record_ft: true
  tactile_display_viz: true
  data_logger:
    collect_data: false
    total_trajectories: 1
    base_folder: /home/roblab20/tactile_tests
    sub_folder: datastore_real
  rl:
    max_episode_length: 1000
    pos_action_scale:
    - 0.009
    - 0.009
    - 0.004
    rot_action_scale:
    - 0.02
    - 0.02
    - 0.02
    clamp_rot: ${...task.rl.clamp_rot}
    clamp_rot_thresh: ${...task.rl.clamp_rot_thresh}
  env:
    depth_cam: false
    hand: true
    arm: true
    ext_cam: true
    tactile: true
    tactile_seq_length: ${...task.env.tactile_history_len}
    ft_seq_length: ${...task.env.ft_history_len}
    obs_seq_length: ${...task.env.numObsHist}
    stud_obs_seq_length: ${...task.env.numObsStudentHist}
    priv_info_dim: ${...task.env.numStates}
    numObservations: ${...task.env.numObservations}
    numObsStudent: ${...task.env.numObsStudent}
    numActions: ${...task.env.numActions}
    numTargets: ${...task.env.numTargets}
    socket_pos_obs_noise:
    - 0.0
    - 0.0
    - 0.0
    socket_rot_obs_noise:
    - 0.0
    - 0.0
    - 0.0
    fingertip_midpoint_rot_initial:
    - -3.14159265359
    - 0.0
    - -1.57079632679
    kuka_depth: ${...task.env.kuka_depth}
    table_height: ${...task.env.table_height}
    compute_contact_gt: ${...task.env.compute_contact_gt}
    only_contact: ${...task.env.only_contact}
    num_points: ${...task.env.num_points}
  ppo:
    priv_info: true
    extrin_adapt: false
    tactile_info: false
    obs_info: false
    ft_info: false
    tactile_seq_length: ${...task.env.tactile_history_len}
    ft_seq_length: ${...task.env.ft_history_len}
    obs_seq_length: ${...task.env.numObsHist}
    stud_obs_seq_length: ${...task.env.numObsStudentHist}
    priv_info_dim: ${...task.env.numStates}
    student_obs_input_shape: ${...task.env.numObsStudent}
    ft_input_dim: 6
  common_poses:
    socket_pos:
    - 0.5028532612790371
    - 0.001704983755619459
    - 0.001
    joints_above_socket:
    - -0.01306919673345508
    - 0.46035625642851
    - -3.115810324760627
    - -1.5234410615555438
    - -0.012022574425053278
    - -1.1572361716453639
    - 1.5847205313963213
    - 0.0
    joints_above_plug:
    - -0.4343525190442179
    - 0.3393440474185589
    - -3.118461501625801
    - -1.762369221913092
    - -0.010365555594806786
    - -1.0404064904168955
    - 1.172501677329807
pbt:
  enabled: false
offline_train:
  seed: 42
  data_folder: /home/roblab20/tactile_tests/datastore_real
  output_dir: /home/roblab20/tactile_tests/datastore_real
  img_type: depth
  img_color_jitter: false
  img_width: 58
  img_height: 104
  img_gaussian_noise: 0.005
  img_masking_prob: 0.0
  img_patch_size: 16
  img_crop_w: 4
  img_crop_h: 8
  tactile_type: gray
  tactile_gaussian_noise: 0.005
  tactile_masking_prob: 0.0
  tactile_patch_size: 16
  tactile_color_jitter: false
  tactile_width: 36
  tactile_height: 72
  tactile_crop_w: 4
  tactile_crop_h: 8
  train:
    epochs: 50
    train_batch_size: 32
    val_batch_size: 32
    learning_rate: 0.0001
    train_test_split: 0.98
    action_regularization: false
    action_regularization_weight: 0.0
    scheduler: cosine
    warmup: false
    warmup_epochs: 4
    cyclic_period: 10
    plateau_patience: 3
    plateau_factor: 0.5
    latent_scale: 1.0
    action_scale: 1.0
    print_every: 1000
    eval_every: 1000
    test_every: 2000
    test_episodes: 4000
    only_test: false
    only_validate: false
    obs_keys:
    - eef_pos
    - action
    - latent
    - obs_hist
    - noisy_socket_pos
    - socket_pos
    - hand_joints
    - plug_hand_quat
    - plug_hand_pos
    - plug_pos_error
    - plug_quat_error
    normalize_obs_keys:
    - eef_pos
    - noisy_socket_pos
    - action
    - plug_hand_quat
    - plug_hand_pos
    - socket_pos
    load_stats: false
    normalize_file: /home/roblab20/osher3_workspace/src/isaacgym/python/IsaacGymInsertion/isaacgyminsertion/outputs/gt_test/student/normalization.pkl
    load_checkpoint: false
    student_ckpt_path: /home/roblab20/tactile_insertion/datastore_0_contact2/tac+eef/checkpoints/model_2.pt
  model:
    linear:
      input_size: 9
    use_img: true
    use_seg: true
    use_tactile: false
    use_lin: true
    model_type: tact
    transformer:
      sequence_length: 1
      num_layers: 4
      num_heads: 4
      dim_factor: 4
      output_size: 6
      tactile_encoding_size: 64
      img_encoding_size: 64
      seg_encoding_size: 64
      load_tact: false
      tact_path: /home/roblab20/osher3_workspace/src/isaacgym/python/IsaacGymInsertion/isaacgyminsertion/outputs/gt_test/tact/checkpoints/model_last.pt
    tact:
      sequence_length: 1
      num_layers: 4
      num_heads: 4
      dim_factor: 4
      output_size: 6
      tactile_encoding_size: 64
      img_encoding_size: 64
      use_img: false
      use_tactile: false
      use_lin: true
  wandb:
    wandb_enabled: false
    wandb_project_name: tactile_insertion
diffusion_train:
  data_folder: /home/roblab20/tactile_diffusion/datastore_real
  output_dir: /home/roblab20/tactile_diffusion/datastore_real
  gpu: 0
  save_freq: 100
  eval_freq: 10
  print_freq: 100
  eval: false
  load_path: ''
  eval_path: ''
  cond_on_grasp: true
  model_save_path: ''
  epochs: 50
  obs_horizon: 4
  action_horizon: 8
  pred_horizon: 16
  num_diffusion_iters: 100
  batch_size: 16
  learning_rate: 0.0005
  train_test_split: 0.9
  representation_type: eef_pos-tactile
  normalize_keys:
  - eef_pos
  - action
  - arm_joints
  normalize_file: /home/roblab20/tactile_diffusion/datastore_real/normalization.pkl
  img_color_jitter: false
  img_gaussian_noise: 0.0
  img_masking_prob: 0.0
  img_patch_size: 16
  img_dropout_rate: 0.0
  tactile_width: 64
  tactile_height: 64
  tactile_color_jitter: false
  tactile_gaussian_noise: 0.0
  tactile_masking_prob: 0.0
  tactile_patch_size: 16
  tactile_dropout_rate: 0.0
  predict_eef_delta: false
  clip_far: false
  predict_pos_delta: false
  use_ddim: false
  policy_dropout_rate: 0.0
  dropout_rate: 0.0
  weight_decay: 1.0e-05
  state_noise: 0.0
  num_workers: 12
  eef_pos_output_size: 64
  hand_joints_output_size: 64
  arm_joints_output_size: 64
  image_output_size: 64
  tactile_output_size: 64
  without_sampling: false
  compile_train: false
  identity_encoder: false
  wandb_entity_name: None
  wandb_exp_name: None
  use_wandb: false
  wandb_project_name: tactile_diffusion
task_name: ${task.name}
experiment: ''
num_envs: 1
seed: 42
torch_deterministic: false
max_iterations: ''
physics_engine: physx
pipeline: gpu
sim_device: cuda:0
rl_device: cuda:0
graphics_device_id: 0
num_threads: 4
solver_type: 1
num_subscenes: 4
test: false
train_diffusion: false
offline_training: false
train_tactile: false
offline_training_w_env: false
checkpoint: ''
sigma: ''
multi_gpu: true
wandb_activate: false
wandb_group: ''
wandb_name: ${train.params.config.name}
wandb_entity: ''
wandb_project: isaacgymenvs
wandb_tags: []
wandb_logcode_dir: ''
capture_video: true
capture_video_freq: 1464
capture_video_len: 100
force_render: true
headless: true
